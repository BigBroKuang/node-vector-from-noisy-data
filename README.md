code for the paper https://arxiv.org/abs/2111.02630
